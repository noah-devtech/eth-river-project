# 重要な意思決定ログ (Important Design Decisions)

このファイルには、プロジェクトの設計、技術選定、および重要な仕様変更に関する意思決定とその背景が時系列で記録される。

もし時間がなく、たった一行しか書けないとしても、決定事項と**決定理由（Why）**だけは必ず残してください。

---

## 2025-11-18 - 認証方式の変更と理由

**決定日:** 2025-11-18
**関連チケット/PR:** Issue #777
**決定者/担当者:** Gemini

### 1. 背景 (Context / Problem)

既存の Basic 認証は、セキュリティ監査の結果、認証情報の漏洩リスクが高いと指摘された。ビジネス要件として、認証の強度を向上させる必要が生じた。

### 2. 検討された代替案 (Alternatives Considered)

| 選択肢                   | 概要                                       | 採用見送り理由/批判的な観点                                      |
| :----------------------- | :----------------------------------------- | :--------------------------------------------------------------- |
| **Basic 認証の継続**     | 現状維持。最も実装コストが低い。           | セキュリティ要件を満たせないため不適格。                         |
| **OAuth 2.0 (外部 IdP)** | Google などの外部プロバイダを利用。        | 外部サービスへの依存が発生し、ユーザー体験が複雑になる。         |
| **JWT (独自実装)**       | 自前でトークンベースの認証システムを構築。 | 実装と管理の手間が大きい。セキュリティホールを作るリスクがある。 |

### 3. 決定 (Decision)

**二要素認証（TOTP）**を導入し、既存のパスワード認証と組み合わせることを決定した。

### 4. 決定理由 (Rationale)

-   **手軽なセキュリティ向上:** 既存のデータベース構造を変更することなく、比較的容易に認証強度を大幅に向上させることができる。
-   **規制対応:** 監査で指摘されたセキュリティ要件（多要素認証）を直接満たす。
-   **依存関係:** 外部の認証プロバイダへの依存を避け、シンプルさを維持できる。

### 5. 影響と結果 (Consequences)

ユーザーはログイン時に認証アプリ（Google Authenticator など）の設定が必要となる。フロントエンドの実装に影響がある。
