# プロジェクト全体 TODO リスト

このファイルはEthernet Riverの全体的なタスク・進捗管理用です。

---

## 現在の TODO リスト

- [ ] TCPハンドシェイク処理の追加
    SYN/FINフラグを判別し、接続の開始と終了を視覚的に区別できるラベルでOSC送信する。
- [ ] プロトコル判定の高度化 (HTTPS/QUIC/ICMP/DATA)
    443番ポートかつマジックナンバー（16 03 ...）確認で `HTTPS`、UDP/443で `QUIC`、プロトコル番号1で `ICMP` と判定。解析不能だがデータがある場合は`DATA`と表示するロジックを実装。
- [ ] パフォーマンス改善（pysharkのボトルネック調査・最適化）
    EK JSON モードへの切り替え
- [ ] `.env`ファイルによる環境変数の導入
    `TARGET_PREFIXES` や `network_interface` 等のハードコードを解消。`.env` からIP、ポート、CIDR、デフォルトゲートウェイ、デバッグ表示フラグ等を読み込む。
- [ ] Python解析側の非同期送信の実装
    パケット解析とOSC送信を別スレッドに分離。ラズパイ4でのパケット取りこぼしを防止。
- [ ] 解析情報の最小化
    ペイロードの詳細取得を廃止し、IP/ポート/サイズ/プロトコルのみに絞る。
- [ ] パケットの最大サイズを1500に。
- [ ] デフォルトゲートウェイの画面中央固定
    `.env` で指定したゲートウェイIPのノードを画面中央に配置し、`isFixed` フラグで位置を固定。
- [ ] CIDRベースのブロードキャスト/ループバック演出
    サブネット末尾のアドレス（ブロードキャスト）や `255.255.255.255` への通信時、画面上の全アクティブノードへパーティクルを飛ばす。`127.0.0.0/8` は自己完結演出にする。
- [ ] ノード挙動の「ゆったり化」と境界反発の調整
    速度に摩擦（0.95f程度の減衰）を導入し、中心への引力を弱める。画面端に近づいた時だけ押し戻す「ソフト境界」を実装。
- [ ] OSC経由でのノード名（表示文字列）の動的更新
    IPアドレスの代わりに任意の文字列をノードに表示するマッピング機能を実装。
- [ ] デバッグウィンドウの別ウィンドウ化とControlP5連携
    `PApplet.runSketch`で第2ウィンドウを生成し、そこに `ControlP5` を配置。パーティクル速度や斥力、フォント設定などをリアルタイムで操作可能に。

---

## 余裕があれば実装すること

- [ ] エッジブレンディング用シェーダーの実装
    プロジェクター2台を横に並べる可能性がある場合、重なり部分にグラデーションマスクをかけるシェーダーを実装。
- [ ] デバッグウィンドウのタイポグラフィ（フォント）変更
    `ControlP5`に`PFont` / `ControlFont` を適用し、日本語表示やデザイン性の高いフォントへの切り替えを可能に。

---

## 更新方法

- 新しいタスクや完了済みタスクはこのファイルに追記・修正してください。
